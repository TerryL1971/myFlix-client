var helpers = require("../../../../../../.nvm/versions/node/v14.17.0/lib/node_modules/parcel/node_modules/@parcel/transformer-react-refresh-wrap/lib/helpers/helpers.js");
var prevRefreshReg = window.$RefreshReg$;
var prevRefreshSig = window.$RefreshSig$;
helpers.prelude(module);

try {
var parcelHelpers = require("@parcel/transformer-js/src/esmodule-helpers.js");
parcelHelpers.defineInteropFlag(exports);
parcelHelpers.export(exports, "MovieView", ()=>MovieView
);
var _react = require("react");
var _reactDefault = parcelHelpers.interopDefault(_react);
var _reactRouterDom = require("react-router-dom");
var _button = require("react-bootstrap/Button");
var _buttonDefault = parcelHelpers.interopDefault(_button);
var _image = require("react-bootstrap/esm/Image");
class MovieView extends _reactDefault.default.Component {
    constructor(props){
        super(props);
        this.state = {
            // this state is the text of the button for adding or removing a movie
            buttonText: ''
        };
    }
    //Set the text of the button for add/remove a movie when the page loads or refreshes based on the content of the favorite_movies array.
    componentDidMount() {
        const favMovies = this.props.user.favoriteMovies;
        const movieId = this.props.movie._id;
        if (favMovies.includes(movieId)) this.setState({
            buttonText: 'Remove from favorites'
        });
        if (!favMovies.includes(movieId)) this.setState({
            buttonText: 'Add to favorites'
        });
    }
    render() {
        const { movie , clickBack , token , user , onMovieAddorDelete  } = this.props;
        const { buttonText  } = this.state;
        const { username  } = user;
        // Add a movie to favorites
        const addMovie = ()=>{
            const userName = username;
            const accessToken = token;
            const movieId = movie._id;
            const url = `https://myflix-app-2021.herokuapp.com/users/${userName}/favoriteMovies/${movieId}`;
            // axios.post(url , {
            //     headers: {Authorization: `Bearer ${token}`}
            // })
            fetch(url, {
                method: 'POST',
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": "Bearer " + accessToken
                }
            }).then((response)=>{
                return response.json();
            }).then((data)=>{
                const userObj = data;
                // prop that updates the state of a users favoriteVovies if a film is added to favorites
                onMovieAddorDelete(user);
            }).catch((err)=>{
                console.log(err);
            });
        };
        // Delete a film from favorites
        const deleteMovie = ()=>{
            axios.delete(`https://myflix-app-2021.herokuapp.com/users/${username}/favoriteMovies/${movie._id}`, {
                headers: {
                    Authorization: `Bearer ${token}`
                }
            }).then((response)=>{
                const data = response.data;
                // prop that updates the state of a users favoriteMovies if a film is deleted from favorites
                onMovieAddorDelete(data);
            }).catch((err)=>{
                console.log(err);
            });
        };
        // Set the text of the button for add/remove a movie, when a user adds or removes a movie from favorites
        const addRemove = ()=>{
            if (user.favoriteMovies.includes(movie._id)) {
                this.setState({
                    buttonText: 'Add to favorites'
                });
                deleteMovie();
            } else {
                this.setState({
                    buttonText: 'Remove from favorites'
                });
                addMovie();
            }
        };
        return(/*#__PURE__*/ _reactDefault.default.createElement("div", {
            className: "movie-view",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 89
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement("div", {
            className: "movie-poster",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 90
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement("img", {
            src: movie.ImagePath,
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 91
            },
            __self: this
        })), /*#__PURE__*/ _reactDefault.default.createElement("div", {
            className: "movie-title",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 93
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement("span", {
            className: "label",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 94
            },
            __self: this
        }, "Title: "), /*#__PURE__*/ _reactDefault.default.createElement("span", {
            className: "value",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 95
            },
            __self: this
        }, movie.Title)), /*#__PURE__*/ _reactDefault.default.createElement("div", {
            className: "movie-description",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 97
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement("span", {
            className: "label",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 98
            },
            __self: this
        }, "Description: "), /*#__PURE__*/ _reactDefault.default.createElement("span", {
            className: "value",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 99
            },
            __self: this
        }, movie.Description)), /*#__PURE__*/ _reactDefault.default.createElement("div", {
            className: "movie-genre",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 101
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement("span", {
            className: "label",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 102
            },
            __self: this
        }, "Genre: "), /*#__PURE__*/ _reactDefault.default.createElement("span", {
            className: "value",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 103
            },
            __self: this
        }, movie.Genre.Name)), /*#__PURE__*/ _reactDefault.default.createElement("div", {
            className: "movie-director",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 105
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement("span", {
            className: "label",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 106
            },
            __self: this
        }, "Director: "), /*#__PURE__*/ _reactDefault.default.createElement("span", {
            className: "value",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 107
            },
            __self: this
        }, movie.Director.Name)), /*#__PURE__*/ _reactDefault.default.createElement("button", {
            onClick: ()=>{
                onBackClick(null);
            },
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 109
            },
            __self: this
        }, "Back"), /*#__PURE__*/ _reactDefault.default.createElement(_reactRouterDom.Link, {
            to: `/directors/${movie.Director.Name}`,
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 111
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement(_buttonDefault.default, {
            variant: "link",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 112
            },
            __self: this
        }, "Director")), /*#__PURE__*/ _reactDefault.default.createElement(_reactRouterDom.Link, {
            to: `/genres/${movie.Genre.Name}`,
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 115
            },
            __self: this
        }, /*#__PURE__*/ _reactDefault.default.createElement(_buttonDefault.default, {
            variant: "link",
            __source: {
                fileName: "/Users/terry_c_lombardi/Desktop/myFlix-client/myFlix-client/src/components/movie-view/movie-view.jsx",
                lineNumber: 116
            },
            __self: this
        }, "Genre"))));
    }
}

  helpers.postlude(module);
} finally {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
}